See ppi3d.py for details.
